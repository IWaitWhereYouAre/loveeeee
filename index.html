<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>The Secret Garden | ISA Chulalongkorn</title>

  <!-- Elegant, “princess / aristocratic” type -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,300..900;1,300..900&family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=Lato:wght@300;400&display=swap" rel="stylesheet">

  <style>
    :root{
      --moss:#162418;
      --moss2:#0b120c;
      --gold:#c5a059;
      --gold2:#f0d79b;
      --cream:#f8f5f0;
      --petal:#fce3e3;
      --sky:#e0f0f5;

      --glass: rgba(255,255,255,.06);
      --border: rgba(197,160,89,.28);
      --shadow: rgba(0,0,0,.45);
    }

    html, body {
      margin:0; padding:0;
      width:100%; height:100%;
      overflow:hidden;
      background: radial-gradient(1200px 800px at 50% 40%, #1b2a1e 0%, #050805 70%, #020302 100%);
      color: var(--cream);
    }

    /* Canvas sits behind everything */
    #garden {
      position:fixed; inset:0;
      width:100%; height:100%;
      z-index:0;
    }

    /* Soft vignette + sparkles overlay */
    .veil {
      position: fixed; inset:0;
      pointer-events:none;
      z-index: 2;
      background:
        radial-gradient(1200px 800px at 50% 40%, rgba(255,255,255,.05) 0%, rgba(0,0,0,.35) 55%, rgba(0,0,0,.7) 100%),
        radial-gradient(700px 500px at 25% 30%, rgba(197,160,89,.06) 0%, transparent 60%),
        radial-gradient(700px 500px at 80% 55%, rgba(252,227,227,.05) 0%, transparent 60%);
      mix-blend-mode: screen;
      opacity: .9;
    }

    /* UI */
    #ui {
      position: relative;
      z-index: 5;
      height: 100%;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 20px;
    }

    .card {
      width:min(520px, 92vw);
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.04));
      border: 1px solid var(--border);
      box-shadow: 0 24px 90px var(--shadow);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      padding: 44px 42px;
      position: relative;
      overflow:hidden;
    }

    /* Ornamental corners */
    .card::before, .card::after{
      content:"";
      position:absolute;
      inset:-2px;
      pointer-events:none;
      border: 1px solid rgba(240,215,155,.14);
      mask:
        radial-gradient(14px 14px at 18px 18px, transparent 60%, #000 61%) top left,
        radial-gradient(14px 14px at calc(100% - 18px) 18px, transparent 60%, #000 61%) top right,
        radial-gradient(14px 14px at 18px calc(100% - 18px), transparent 60%, #000 61%) bottom left,
        radial-gradient(14px 14px at calc(100% - 18px) calc(100% - 18px), transparent 60%, #000 61%) bottom right;
      mask-repeat:no-repeat;
      mask-size: 50% 50%;
      opacity:.9;
    }

    .frame {
      position:absolute;
      inset: 14px;
      border: 1px solid rgba(197,160,89,.18);
      pointer-events:none;
    }

    .topline {
      display:flex;
      flex-direction:column;
      gap: 10px;
      align-items:center;
      text-align:center;
    }

    .brand {
      font-family: "Lato", system-ui, -apple-system, Segoe UI, Arial, sans-serif;
      text-transform: uppercase;
      letter-spacing: .32em;
      font-size: 12px;
      opacity: .75;
    }

    h1 {
      margin: 4px 0 0;
      font-family: "Playfair Display", serif;
      font-style: italic;
      font-weight: 400;
      letter-spacing: .18em;
      color: var(--gold2);
      font-size: clamp(28px, 4.5vw, 40px);
      text-shadow: 0 0 24px rgba(240,215,155,.10);
    }

    .subtitle {
      font-family: "Cormorant Garamond", serif;
      font-size: 18px;
      letter-spacing: .08em;
      opacity: .86;
      margin-top: 6px;
    }

    .divider {
      width: 160px;
      height: 1px;
      margin: 18px auto 14px;
      background: linear-gradient(90deg, transparent, rgba(240,215,155,.55), transparent);
    }

    .text {
      font-family: "Cormorant Garamond", serif;
      font-size: 18px;
      line-height: 1.7;
      letter-spacing: .04em;
      opacity: .92;
      margin: 0;
      text-align:center;
    }

    .hint {
      margin-top: 14px;
      font-family:"Lato", sans-serif;
      font-size: 12px;
      letter-spacing:.22em;
      text-transform: uppercase;
      opacity:.65;
      text-align:center;
    }

    .actions {
      display:flex;
      gap: 10px;
      margin-top: 24px;
      justify-content:center;
      flex-wrap:wrap;
    }

    button {
      appearance:none;
      border: 1px solid rgba(240,215,155,.55);
      background: linear-gradient(180deg, rgba(197,160,89,.10), rgba(197,160,89,.03));
      color: var(--gold2);
      padding: 12px 18px;
      cursor:pointer;
      text-transform: uppercase;
      letter-spacing: .28em;
      font-size: 12px;
      font-family: "Lato", sans-serif;
      transition: transform .15s ease, background .2s ease, color .2s ease, border-color .2s ease;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
    }
    button:hover {
      transform: translateY(-1px);
      background: linear-gradient(180deg, rgba(240,215,155,.20), rgba(197,160,89,.06));
      border-color: rgba(240,215,155,.75);
    }
    button:active { transform: translateY(0px); }

    .ghost {
      border-color: rgba(255,255,255,.25);
      color: rgba(255,255,255,.86);
      background: rgba(255,255,255,.04);
    }

    /* Toggle panels */
    #scene { display:none; }
    .mini {
      margin-top: 14px;
      display:flex;
      justify-content:center;
      gap: 12px;
      font-family:"Lato", sans-serif;
      font-size: 12px;
      opacity: .75;
      letter-spacing: .06em;
    }
    .mini input[type="range"] { width: 140px; }

    /* small footer */
    .foot {
      margin-top: 18px;
      text-align:center;
      font-family:"Lato", sans-serif;
      font-size: 11px;
      letter-spacing:.16em;
      text-transform: uppercase;
      opacity:.55;
    }
  </style>
</head>

<body>
  <canvas id="garden"></canvas>
  <div class="veil"></div>

  <div id="ui">
    <div class="card">
      <div class="frame"></div>

      <div id="start">
        <div class="topline">
          <div class="brand">Hosted by International Student Affairs (ISA) • Chulalongkorn University</div>
          <h1>HEART TO HEART</h1>
          <div class="subtitle">Enter the secret garden. Let the air sing.</div>
        </div>

        <div class="divider"></div>
        <p class="text">
          A quiet aristocratic garden—golden vines, drifting petals, and soft wind.
          Tap “Enter” to awaken the soundscape.
        </p>
        <div class="hint">Tip: move your cursor / touch to guide the breeze</div>

        <div class="actions">
          <button id="enterBtn">Enter</button>
          <button id="muteBtn" class="ghost" aria-pressed="false">Sound: Off</button>
        </div>

        <div class="foot">The Secret Garden • ISA Chula</div>
      </div>

      <div id="scene">
        <div class="topline">
          <div class="brand">THEME</div>
          <h1 id="themeTitle">Blooming</h1>
          <div class="divider"></div>
          <p class="text" id="quoteText"></p>
          <div class="hint">Click anywhere for a new “bloom”</div>
        </div>

        <div class="mini" title="Adjust ambience">
          <span>Wind</span><input id="windVol" type="range" min="0" max="1" step="0.01" value="0.55">
          <span>Birds</span><input id="birdVol" type="range" min="0" max="1" step="0.01" value="0.45">
        </div>

        <div class="actions">
          <button id="newBtn">New Bloom</button>
          <button id="backBtn" class="ghost">Return</button>
        </div>

        <div class="foot">Make it Instagrammable ✦ screenshot anytime</div>
      </div>
    </div>
  </div>

  <script>
    // =========================
    // CANVAS: PRINCESS GARDEN
    // =========================
    const canvas = document.getElementById("garden");
    const ctx = canvas.getContext("2d", { alpha: true });

    const DPR = Math.max(1, Math.min(2, window.devicePixelRatio || 1));

    function resize() {
      canvas.width = Math.floor(window.innerWidth * DPR);
      canvas.height = Math.floor(window.innerHeight * DPR);
      canvas.style.width = "100%";
      canvas.style.height = "100%";
      ctx.setTransform(DPR,0,0,DPR,0,0);
    }
    window.addEventListener("resize", resize);
    resize();

    let pointer = { x: window.innerWidth * 0.5, y: window.innerHeight * 0.5 };
    window.addEventListener("mousemove", (e)=>{ pointer.x = e.clientX; pointer.y = e.clientY; });
    window.addEventListener("touchmove", (e)=>{
      if (!e.touches || !e.touches[0]) return;
      pointer.x = e.touches[0].clientX;
      pointer.y = e.touches[0].clientY;
    }, { passive:true });

    // Subtle “wind field”
    let t = 0;
    function windAngle(x, y) {
      // A gentle flow with pointer influence
      const px = (pointer.x / window.innerWidth - 0.5) * 2;
      const py = (pointer.y / window.innerHeight - 0.5) * 2;
      const base = Math.sin((x * 0.002) + t*0.8) + Math.cos((y * 0.002) - t*0.6);
      return base * 0.5 + (px * 0.35) - (py * 0.2);
    }

    // Particles: petals + firefly specks
    const petals = [];
    const specks = [];

    function rand(min,max){ return min + Math.random()*(max-min); }

    function spawnPetal() {
      petals.push({
        x: rand(-50, window.innerWidth + 50),
        y: rand(-60, -10),
        r: rand(1.5, 3.4),
        a: rand(0, Math.PI*2),
        spin: rand(-0.03, 0.03),
        drift: rand(0.2, 0.8),
        fall: rand(0.5, 1.3),
        life: rand(800, 1400)
      });
    }
    function spawnSpeck() {
      specks.push({
        x: rand(0, window.innerWidth),
        y: rand(0, window.innerHeight),
        r: rand(0.8, 1.6),
        p: rand(0.2, 0.7),
        tw: rand(0.008, 0.02)
      });
    }

    for(let i=0;i<60;i++) spawnSpeck();
    for(let i=0;i<16;i++) spawnPetal();

    // Vines / branches
    class Vine {
      constructor(x,y,angle,len,depth){
        this.x=x; this.y=y;
        this.angle=angle;
        this.len=len;
        this.depth=depth;
        this.g=0;
        this.children=null;
        this.tipBloomed=false;
      }
      step(){
        if (this.g < 1) this.g += 0.015 + (0.004 * (1/this.depth));
      }
      draw(){
        this.step();
        const cur = this.len * Math.min(1, this.g);
        const sway = windAngle(this.x, this.y) * 0.08 * (1/this.depth);
        const ang = this.angle + sway;

        const ex = this.x + Math.cos(ang)*cur;
        const ey = this.y + Math.sin(ang)*cur;

        ctx.beginPath();
        ctx.moveTo(this.x, this.y);
        ctx.lineTo(ex, ey);

        const alpha = Math.min(0.9, 0.95 / this.depth);
        ctx.strokeStyle = `rgba(240,215,155,${alpha})`;
        ctx.lineWidth = Math.max(0.6, 2.3 / this.depth);
        ctx.stroke();

        // Children
        if (this.g >= 1 && this.depth < 5) {
          if (!this.children) {
            const spread = rand(0.35, 0.55);
            const shrink = rand(0.70, 0.86);
            this.children = [
              new Vine(ex, ey, ang - spread, this.len*shrink, this.depth+1),
              new Vine(ex, ey, ang + spread, this.len*shrink, this.depth+1),
            ];
            if (Math.random() < 0.25) {
              this.children.push(new Vine(ex, ey, ang + rand(-0.15,0.15), this.len*shrink*0.85, this.depth+1));
            }
          }
          this.children.forEach(v => v.draw());
        } else if (this.g >= 1 && !this.tipBloomed) {
          this.tipBloomed = true;
          // Create a tiny bloom at the tip
          for(let i=0;i<5;i++){
            petals.push({
              x: ex + rand(-6,6),
              y: ey + rand(-6,6),
              r: rand(1.2, 2.6),
              a: rand(0, Math.PI*2),
              spin: rand(-0.05, 0.05),
              drift: rand(0.1, 0.7),
              fall: rand(0.3, 1.0),
              life: rand(500, 900),
              local: true
            });
          }
        }
      }
    }

    let vines = [];
    function resetVines() {
      vines = [];
      const w = window.innerWidth, h = window.innerHeight;
      const count = 5;
      for (let i=0;i<count;i++){
        const x = rand(0.1*w, 0.9*w);
        vines.push(new Vine(x, h + rand(10,60), -Math.PI/2 + rand(-0.18, 0.18), rand(140, 200), 1));
      }
      // a couple side vines for “framing”
      vines.push(new Vine(-20, h*0.88, -Math.PI/2 + 0.35, 190, 1));
      vines.push(new Vine(w+20, h*0.88, -Math.PI/2 - 0.35, 190, 1));
    }

    // Background paint
    function paintBackdrop(){
      // soft dark wash
      ctx.fillStyle = "rgba(6, 9, 7, 0.16)";
      ctx.fillRect(0,0,window.innerWidth, window.innerHeight);

      // a faint “moon-glow” for aristocratic vibe
      const g = ctx.createRadialGradient(
        window.innerWidth*0.55, window.innerHeight*0.26, 10,
        window.innerWidth*0.55, window.innerHeight*0.26, Math.max(window.innerWidth, window.innerHeight)*0.55
      );
      g.addColorStop(0, "rgba(240,215,155,0.06)");
      g.addColorStop(0.35, "rgba(197,160,89,0.03)");
      g.addColorStop(1, "rgba(0,0,0,0)");
      ctx.fillStyle = g;
      ctx.fillRect(0,0,window.innerWidth, window.innerHeight);
    }

    function drawSpecks(){
      for(const s of specks){
        s.p += s.tw;
        const a = 0.18 + 0.18*Math.sin(s.p);
        ctx.beginPath();
        ctx.arc(s.x, s.y, s.r, 0, Math.PI*2);
        ctx.fillStyle = `rgba(240,215,155,${a})`;
        ctx.fill();
      }
    }

    function drawPetals(){
      for (let i=petals.length-1;i>=0;i--){
        const p = petals[i];
        p.life -= 1;
        if (p.life <= 0 || p.y > window.innerHeight + 80) {
          petals.splice(i,1);
          continue;
        }
        const wa = windAngle(p.x, p.y);
        p.a += p.spin + wa*0.01;
        p.x += Math.sin(p.a)*p.drift + wa*0.7;
        p.y += p.fall + (0.25 + Math.abs(wa))*0.2;

        // petal shape
        ctx.save();
        ctx.translate(p.x, p.y);
        ctx.rotate(p.a);
        ctx.beginPath();
        // little teardrop petal
        ctx.moveTo(0, -p.r);
        ctx.quadraticCurveTo(p.r*0.9, 0, 0, p.r);
        ctx.quadraticCurveTo(-p.r*0.9, 0, 0, -p.r);
        ctx.closePath();
        ctx.fillStyle = "rgba(252,227,227,0.88)";
        ctx.fill();

        // gold edge highlight
        ctx.strokeStyle = "rgba(240,215,155,0.25)";
        ctx.lineWidth = 1;
        ctx.stroke();
        ctx.restore();
      }
      // keep a gentle stream
      if (petals.length < 22 && Math.random() < 0.20) spawnPetal();
    }

    let running = false;
    function loop(){
      if (!running) return;
      t += 0.012;
      paintBackdrop();
      drawSpecks();
      vines.forEach(v => v.draw());
      drawPetals();
      requestAnimationFrame(loop);
    }

    // =========================
    // AUDIO: WIND + BIRDS
    // =========================
    let audioCtx = null;
    let master = null;

    let windGain = null, birdsGain = null;
    let windNode = null;
    let windLP = null;
    let windHP = null;
    let windLFO = null, windLFOGain = null;

    let birdsTimer = null;
    let soundOn = false;

    function ensureAudio() {
      if (audioCtx) return;
      audioCtx = new (window.AudioContext || window.webkitAudioContext)();

      master = audioCtx.createGain();
      master.gain.value = 0.9;
      master.connect(audioCtx.destination);

      windGain = audioCtx.createGain();
      birdsGain = audioCtx.createGain();
      windGain.gain.value = 0.55;
      birdsGain.gain.value = 0.45;

      windGain.connect(master);
      birdsGain.connect(master);

      // Wind = filtered noise with slow amplitude movement
      windNode = makeNoise(audioCtx);
      windLP = audioCtx.createBiquadFilter();
      windLP.type = "lowpass";
      windLP.frequency.value = 800;

      windHP = audioCtx.createBiquadFilter();
      windHP.type = "highpass";
      windHP.frequency.value = 80;

      // LFO for “gusts”
      windLFO = audioCtx.createOscillator();
      windLFO.type = "sine";
      windLFO.frequency.value = 0.11;

      windLFOGain = audioCtx.createGain();
      windLFOGain.gain.value = 0.25;

      windLFO.connect(windLFOGain);
      windLFOGain.connect(windGain.gain);

      windNode.connect(windLP);
      windLP.connect(windHP);
      windHP.connect(windGain);

      windLFO.start();
      windNode.start();
    }

    function makeNoise(ctx){
      const bufferSize = 2 * ctx.sampleRate;
      const buffer = ctx.createBuffer(1, bufferSize, ctx.sampleRate);
      const data = buffer.getChannelData(0);
      for (let i=0;i<bufferSize;i++){
        data[i] = (Math.random() * 2 - 1) * 0.9;
      }
      const src = ctx.createBufferSource();
      src.buffer = buffer;
      src.loop = true;
      return src;
    }

    function chirp() {
      if (!audioCtx || !soundOn) return;

      // A tiny “bird” made of 2 oscillators + quick envelopes
      const now = audioCtx.currentTime;

      const o1 = audioCtx.createOscillator();
      const o2 = audioCtx.createOscillator();
      const g = audioCtx.createGain();

      o1.type = "sine";
      o2.type = "triangle";

      const base = 1800 + Math.random()*1600; // 1800–3400
      const up = base + 900 + Math.random()*700;

      o1.frequency.setValueAtTime(base, now);
      o1.frequency.exponentialRampToValueAtTime(up, now + 0.06);
      o1.frequency.exponentialRampToValueAtTime(base*0.65, now + 0.16);

      o2.frequency.setValueAtTime(base*0.52, now);
      o2.frequency.exponentialRampToValueAtTime(base*0.9, now + 0.08);
      o2.frequency.exponentialRampToValueAtTime(base*0.5, now + 0.16);

      g.gain.setValueAtTime(0.0001, now);
      g.gain.exponentialRampToValueAtTime(0.12, now + 0.02);
      g.gain.exponentialRampToValueAtTime(0.0001, now + 0.18);

      // tiny reverb-ish feel using a short delay
      const delay = audioCtx.createDelay();
      delay.delayTime.value = 0.03 + Math.random()*0.015;

      const fb = audioCtx.createGain();
      fb.gain.value = 0.18;

      g.connect(delay);
      delay.connect(fb);
      fb.connect(delay);

      // route
      o1.connect(g);
      o2.connect(g);

      delay.connect(birdsGain);
      g.connect(birdsGain);

      o1.start(now);
      o2.start(now);
      o1.stop(now + 0.22);
      o2.stop(now + 0.22);
    }

    function scheduleBirds() {
      if (birdsTimer) clearTimeout(birdsTimer);
      const next = 1200 + Math.random()*3800; // 1.2s–5s
      birdsTimer = setTimeout(() => {
        // sometimes a double-chirp
        chirp();
        if (Math.random() < 0.35) setTimeout(chirp, 120 + Math.random()*140);
        scheduleBirds();
      }, next);
    }

    function setSound(on) {
      soundOn = on;
      const muteBtn = document.getElementById("muteBtn");
      if (!audioCtx && on) ensureAudio();

      if (audioCtx) {
        const now = audioCtx.currentTime;
        const targetMaster = on ? 0.9 : 0.0001;
        master.gain.cancelScheduledValues(now);
        master.gain.setValueAtTime(master.gain.value, now);
        master.gain.exponentialRampToValueAtTime(targetMaster, now + 0.08);

        if (on) {
          scheduleBirds();
          if (audioCtx.state === "suspended") audioCtx.resume();
        } else {
          if (birdsTimer) clearTimeout(birdsTimer);
          birdsTimer = null;
        }
      }

      muteBtn.textContent = on ? "Sound: On" : "Sound: Off";
      muteBtn.setAttribute("aria-pressed", on ? "true" : "false");
    }

    // =========================
    // QUOTES / UI FLOW
    // =========================
    const QUOTES = [
      {
        theme: "Blooming",
        text: "The world is full of magic things, patiently waiting for our senses to grow sharper."
      },
      {
        theme: "Gentle Courage",
        text: "Softness is not weakness. It is the bravest way to stay open."
      },
      {
        theme: "Golden Patience",
        text: "Some doors open only when you stop pushing and start listening."
      },
      {
        theme: "Secret Promise",
        text: "If you keep returning to the garden, it eventually learns your name."
      }
    ];

    function newBloom() {
      const pick = QUOTES[Math.floor(Math.random()*QUOTES.length)];
      document.getElementById("themeTitle").textContent = pick.theme;
      document.getElementById("quoteText").textContent = pick.text;

      // refresh visuals a bit
      resetVines();
      for(let i=0;i<6;i++) spawnPetal();
    }

    const enterBtn = document.getElementById("enterBtn");
    const muteBtn  = document.getElementById("muteBtn");
    const start    = document.getElementById("start");
    const scene    = document.getElementById("scene");
    const newBtn   = document.getElementById("newBtn");
    const backBtn  = document.getElementById("backBtn");

    const windVol = document.getElementById("windVol");
    const birdVol = document.getElementById("birdVol");

    muteBtn.addEventListener("click", () => setSound(!soundOn));

    enterBtn.addEventListener("click", async () => {
      // Must be user-gesture to start audio on many browsers
      setSound(true);

      start.style.display = "none";
      scene.style.display = "block";

      newBloom();
      resetVines();

      // start animation
      running = true;
      loop();
    });

    newBtn.addEventListener("click", newBloom);

    backBtn.addEventListener("click", () => {
      scene.style.display = "none";
      start.style.display = "block";
      // keep visuals running softly in background, but you can stop if you want:
      // running = false;
    });

    // click anywhere for a new bloom (in scene)
    window.addEventListener("click", (e) => {
      if (scene.style.display === "block") {
        // ignore button clicks (they already handle)
        const tag = (e.target && e.target.tagName) ? e.target.tagName.toLowerCase() : "";
        if (tag !== "button" && tag !== "input") newBloom();
      }
    });

    // sliders
    windVol.addEventListener("input", () => {
      if (!audioCtx) return;
      windGain.gain.setTargetAtTime(parseFloat(windVol.value), audioCtx.currentTime, 0.05);
    });
    birdVol.addEventListener("input", () => {
      if (!audioCtx) return;
      birdsGain.gain.setTargetAtTime(parseFloat(birdVol.value), audioCtx.currentTime, 0.05);
    });

    // initialize quiet background (no drawing until enter)
    paintBackdrop();
    drawSpecks();
    drawPetals();
  </script>
</body>
</html>
